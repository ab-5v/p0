(function(t){"use strict";var e="function",c="object",i="reject",r="fulfill",f=0,n=typeof module==c&&module.exports;function s(){this._act=f;this._cbs=[];this._ebs=[]}s.tick=n?process.nextTick:setTimeout;s.prototype={_exec:function(t){var e=this._val,c=this._act;s.tick(function(){var i,r,f;while(i=t.shift()){r=i.pr;f=o(i.cb);if(f){try{r.fulfill(f(e))}catch(n){r.reject(n)}}else{r[c](e)}}})},reject:function(t){var e=this;if(e._act===f){e._val=t;e._act=i;e._exec(e._ebs)}},fulfill:function(t){var i,n,s=this,l=1;if(s._act===f){try{if(t===s){throw TypeError()}n=t&&typeof t;i=(n===e||n===c)&&t.then}catch(u){s.reject(u);return}if(o(i)){try{i.call(t,function(t){l=l&&s.fulfill(t)},function(t){l=l&&s.reject(t)})}catch(u){l=l&&s.reject(u)}}else{s._val=t;s._act=r;s._exec(s._cbs)}}},then:function(t,e){var c=this,r=new s;if(c._act===f){c._cbs.push({cb:t,pr:r});c._ebs.push({cb:e,pr:r})}else{c._exec([{cb:c._act==i?e:t,pr:r}])}return r}};if(n){module.exports=s}else{(t||window).p0=s}function o(t){return typeof t==e&&t}})(this);