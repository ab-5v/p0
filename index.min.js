(function(t){var e="function",c="reject",i="fulfill",r=0;function f(){this._act=r;this._cbs=[];this._ebs=[]}f.tick=setTimeout;f.prototype={_exec:function(t){var e=this._val,c=this._act;f.tick(function(){var i,r,f;while(i=t.shift()){r=i.pr;f=n(i.cb);if(f){try{r.fulfill(f(e))}catch(l){r.reject(l)}}else{r[c](e)}}})},reject:function(t){var e=this;if(e._act===r){e._val=t;e._act=c;e._exec(e._ebs)}},fulfill:function(t){var c,f,l=this,o=1;if(l._act===r){try{if(t===l){throw TypeError()}f=t&&typeof t;c=(f===e||f==="object")&&t.then}catch(s){l.reject(s);return}if(n(c)){try{c.call(t,function(t){o=o&&l.fulfill(t)},function(t){o=o&&l.reject(t)})}catch(s){o=o&&l.reject(s)}}else{l._val=t;l._act=i;l._exec(l._cbs)}}},then:function(t,e){var i=this,n=new f;if(i._act===r){i._cbs.push({cb:t,pr:n});i._ebs.push({cb:e,pr:n})}else{i._exec([{cb:i._act==c?e:t,pr:n}])}return n}};if(typeof module!="undefined"&&module.exports){module.exports=f}else{t.p0=f}function n(t){return typeof t==e&&t}})(this);