(function(t){"use strict";var e="function",c="object",i="reject",r="fulfill",f=0,s=typeof module==c&&module.exports;function n(){this._act=f;this._cbs=[];this._ebs=[]}n.tick=s?process.nextTick:setTimeout;n.prototype={_exec:function(t){var c=this._val,i=this._act,r=n.tick;r(function(){var r,f,s;while(r=t.shift()){f=r.pr;s=r.cb;if(typeof s==e){try{f.fulfill(s(c))}catch(n){f.reject(n)}}else{f[i](c)}}})},reject:function(t){var e=this;if(e._act===f){e._val=t;e._act=i;e._exec(e._ebs)}},fulfill:function(t){var i,s,n=this,o=1;if(n._act===f){try{if(t===n){throw TypeError()}s=t&&typeof t;i=(s===e||s===c)&&t.then}catch(l){n.reject(l);return}if(typeof i==e){try{i.call(t,function(t){o=o&&n.fulfill(t)},function(t){o=o&&n.reject(t)})}catch(l){o=o&&n.reject(l)}}else{n._val=t;n._act=r;n._exec(n._cbs)}}},then:function(t,e){var c=this,r=new n;if(c._act===f){c._cbs.push({cb:t,pr:r});c._ebs.push({cb:e,pr:r})}else{c._exec([{cb:c._act==i?e:t,pr:r}])}return r}};if(s){module.exports=n}else{t.p0=n}})(this);