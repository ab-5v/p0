(function(t){"use strict";var e="function",c="object",i="reject",r="fulfill",f=0,l=typeof module==c&&module.exports;function s(){this._act=f;this._cbs=[];this._ebs=[]}s.tick=l?process.nextTick:setTimeout;s.prototype={_exec:function(t){var c=this._val,i=this._act,r=s.tick;r.call(null,function(){var r,f,l;while(r=t.shift()){f=r.pr;l=r.cb;if(typeof l==e){try{f.fulfill(l(c))}catch(s){f.reject(s)}}else{f[i](c)}}})},reject:function(t){var e=this;if(e._act===f){e._val=t;e._act=i;e._exec(e._ebs)}},fulfill:function(t){var i,l,s=this,n=1;if(s._act===f){try{if(t===s){throw TypeError()}l=t&&typeof t;i=(l===e||l===c)&&t.then}catch(o){s.reject(o);return}if(typeof i==e){try{i.call(t,function(t){n=n&&s.fulfill(t)},function(t){n=n&&s.reject(t)})}catch(o){n=n&&s.reject(o)}}else{s._val=t;s._act=r;s._exec(s._cbs)}}},then:function(t,e){var c=this,r=new s;if(c._act===f){c._cbs.push({cb:t,pr:r});c._ebs.push({cb:e,pr:r})}else{c._exec([{cb:c._act==i?e:t,pr:r}])}return r}};if(l){module.exports=s}else{t.p0=s}})(this);